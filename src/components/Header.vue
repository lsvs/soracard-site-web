<script setup lang="ts">
const router = useRouter()

const isOpen = ref(false)

router.afterEach(() => isOpen.value = false)
</script>

<template>
  <Overlay :open="isOpen" @click="isOpen = false" />

  <header class="topbar" :class="{ open: isOpen }">
    <NuxtLink to="/">
      <svg viewBox="0 0 182 30" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path
          d="M7.9 28.2C10 29.4 12.5 30 15.1 30C17.7 30 20.1 29.3 22.3 28.2L15.1 17.5L7.9 28.2ZM15.1 0C6.7 0 0 6.7 0 15C0 19.9 2.2 24.1 5.8 26.9L13.8 15H5.9V12.5H13.9V10H5.9V7.5H24.3V10H16.3V12.5H24.3V15H16.3L24.3 26.9C27.9 24.1 30.1 19.9 30.1 15C30.1 6.7 23.3 0 15.1 0ZM45.9 13.7L44.1 13.6C42.1 13.5 41.2 12.4 41.2 11.1C41.2 9.5 42.4 8.1 44.8 8.1C47.3 8.1 48.4 9.6 48.4 11.2H51.7C51.7 7.5 48.9 5.1 44.7 5.1C40.6 5.1 37.8 7.4 37.8 11C37.8 14.2 40 16.2 43.7 16.5L45.5 16.6C48 16.8 49.2 17.7 49.2 19.1C49.2 20.8 47.8 22.2 44.9 22.2C41.6 22.2 40.5 20.5 40.5 18.9H37.2C37.2 22.5 40 25.1 45 25.1C49.6 25.1 52.7 22.6 52.7 19C52.7 15.9 50 14.1 45.9 13.7ZM75.9 14.9V15.5C75.9 19.8 72.7 25.4 65.8 25.4C58.8 25.4 55.7 19.8 55.7 15.5V14.9C55.7 10.3 59 5.1 65.8 5.1C72.5 5.1 75.9 10.3 75.9 14.9ZM72.4 15.2C72.4 11.3 69.9 8.2 65.8 8.2C61.7 8.2 59.1 11.2 59.1 15.2C59.1 18.9 61.6 22.2 65.8 22.2C69.9 22.2 72.4 19 72.4 15.2ZM90.9 17.8L96.1 24.9H92.3L87.6 18.4H87.4H83.9V24.9H80.5V5.6H87.3C91.8 5.6 94.6 7.6 94.6 11.8V12.2C94.6 15.1 93.3 17 90.9 17.8ZM91.4 12C91.4 9.9 90 8.5 87.8 8.5H84V15.5H87.9C90.1 15.5 91.4 14.1 91.4 12ZM110.1 5.7L116.9 24.8H113.4L111.6 19.5H103L101.2 24.8H97.8L104.5 5.7H110.1ZM110.7 16.7L107.9 8.6H107L104.2 16.7H110.7Z"
          fill="#EE1122" />
        <path
          d="M139.8 17.9H141.7C141.5 19.1 141.1 20.3 140.4 21.3C139.7 22.3 138.8 23.1 137.6 23.7C136.4 24.3 135.1 24.6 133.4 24.6C131.8 24.6 130.4 24.3 129.2 23.7C128 23.1 127.1 22.4 126.4 21.4C125.7 20.5 125.1 19.5 124.8 18.4C124.5 17.3 124.3 16.2 124.3 15.2V14.7C124.3 13.6 124.5 12.5 124.8 11.4C125.1 10.3 125.7 9.29999 126.4 8.39999C127.1 7.49999 128.1 6.79999 129.2 6.19999C130.3 5.69999 131.7 5.39999 133.2 5.39999C134.8 5.39999 136.1 5.69999 137.3 6.19999C138.4 6.69999 139.4 7.49999 140 8.49999C140.7 9.49999 141.1 10.7 141.2 12H139.3C139.2 10.9 138.8 9.99999 138.3 9.29999C137.7 8.59999 137 7.99999 136.1 7.69999C135.2 7.29999 134.3 7.19999 133.2 7.19999C132.1 7.19999 131 7.39999 130.2 7.79999C129.3 8.19999 128.6 8.79999 128 9.49999C127.4 10.2 127 11.1 126.7 12C126.4 12.9 126.3 13.9 126.3 15C126.3 16 126.4 17 126.7 17.9C127 18.8 127.4 19.7 128 20.4C128.6 21.1 129.3 21.7 130.2 22.1C131.1 22.5 132.1 22.7 133.3 22.7C135 22.7 136.4 22.3 137.5 21.4C138.8 20.7 139.5 19.5 139.8 17.9ZM154.5 12.8C154.9 13.5 155.1 14.4 155.1 15.6V24.1H153.6V21.4C153.5 21.8 153.3 22.1 153.1 22.5C152.7 23.2 152.2 23.7 151.5 24C150.8 24.3 150 24.5 149.1 24.5C148.2 24.5 147.3 24.3 146.6 24C145.9 23.7 145.3 23.2 144.9 22.6C144.5 22 144.3 21.2 144.3 20.3C144.3 19.4 144.5 18.7 144.9 18.1C145.3 17.5 145.9 17 146.7 16.7C147.5 16.4 148.4 16.2 149.5 16.2H153.2V15.6C153.2 14.6 152.9 13.9 152.4 13.3C151.9 12.8 151.1 12.5 150 12.5C149.5 12.5 149 12.5 148.5 12.5C148 12.5 147.5 12.5 147.1 12.6C146.6 12.6 146.2 12.7 145.9 12.7V11.1C146.3 11.1 146.6 11 147 11C147.4 11 147.8 10.9 148.2 10.9C148.6 10.9 149 10.9 149.4 10.9C150.7 10.9 151.8 11.1 152.7 11.4C153.6 11.6 154.2 12.1 154.5 12.8ZM153.3 19.3V17.6H149.5C148.5 17.6 147.6 17.9 147.1 18.4C146.5 18.9 146.3 19.6 146.3 20.4C146.3 21.2 146.6 21.9 147.2 22.4C147.8 22.9 148.6 23.1 149.6 23.1C150.2 23.1 150.8 23 151.4 22.8C152 22.6 152.4 22.2 152.8 21.7C153.1 21 153.3 20.2 153.3 19.3ZM162.4 12.2C161.8 12.8 161.5 13.7 161.3 14.8V11H159.8V24.2H161.7V16.9C161.7 15.5 162.1 14.4 162.8 13.6C163.5 12.9 164.6 12.5 166.1 12.5H166.9V10.8H166.5C164.6 10.8 163.3 11.2 162.4 12.2ZM182 5.89999V24.1H180.5V21C180.4 21.2 180.4 21.5 180.2 21.7C179.7 22.6 179 23.3 178.1 23.8C177.2 24.3 176.2 24.5 175.2 24.5C174.2 24.5 173.4 24.3 172.6 24C171.8 23.6 171.1 23.1 170.6 22.5C170 21.9 169.6 21.1 169.3 20.3C169 19.5 168.8 18.6 168.8 17.7V17.4C168.8 16.5 169 15.6 169.2 14.8C169.4 14 169.9 13.2 170.5 12.6C171.1 12 171.7 11.5 172.5 11.1C173.3 10.7 174.2 10.5 175.2 10.5C176.3 10.5 177.3 10.7 178.1 11.2C178.9 11.7 179.6 12.4 180.1 13.3V5.89999H182ZM180.2 16.8C180.2 15.9 180 15 179.6 14.3C179.2 13.6 178.6 13 177.9 12.6C177.2 12.2 176.4 12 175.4 12C174.4 12 173.6 12.2 172.8 12.7C172.1 13.2 171.5 13.8 171.1 14.6C170.7 15.4 170.5 16.3 170.5 17.3C170.5 18.3 170.7 19.3 171.1 20.1C171.5 20.9 172.1 21.6 172.8 22C173.5 22.5 174.4 22.7 175.3 22.7C176.2 22.7 177 22.5 177.7 22.1C178.4 21.7 179 21.1 179.4 20.4C179.8 19.7 180 18.8 180 17.8V16.8H180.2Z"
          fill="#212121" />
      </svg>
    </NuxtLink>

    <div class="nav">
      <HeaderNav />
      <div class="cta">
        <a class="block hover-trigger px-s py-3xs bold text-center" href="https://soracard.com/fees" target="_blank">
          <span class="hover-underline">Fees</span>
        </a>
        <Button href="/" class="block">Apply</Button>
      </div>
    </div>

    <Burger :open="isOpen" @click="isOpen = !isOpen" class="burger" />
  </header>
</template>

<style scoped>
.topbar {
  position: fixed;
  top: 0;
  right: 0;
  left: 0;
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: var(--space-xs);
  z-index: 13;
  perspective: 200rem;
}


.topbar svg {
  display: block;
  height: 3rem;
}

.cta {
  display: flex;
  align-items: center;
}

@media (max-width: 959px) {
  .nav {
    transition: opacity 0.6s var(--ease), transform 1s var(--ease), visibility 0.6s var(--ease);
    opacity: 0;
    visibility: hidden;
    transform: translateY(-2rem) scaleY(0.75);
    transform-origin: top right;
    position: fixed;
    top: 8rem;
    left: var(--space-xs);
    right: var(--space-xs);
    display: grid;
    max-height: 80vh;
    overflow-y: auto;
    border-radius: var(--radius);
    background-color: var(--color-light1);
    box-shadow: var(--shadow);
  }

  .open .nav {
    opacity: 1;
    visibility: visible;
    transform: translateY(0);
  }

  .cta {
    justify-content: center;
    padding: var(--space-xxs) var(--space-s);
  }
}

@media (min-width: 960px) {
  .topbar {
    padding: var(--space-s);
    display: grid;
    grid-template-columns: 1fr 3fr;
  }

  .burger {
    display: none;
  }

  .nav {
    display: grid;
    grid-template-columns: 2fr 1fr;
  }

  .cta {
    justify-content: flex-end;
  }
}
</style>